2025-06-17 16:18:57,346 [INFO] [__main__] Using LocalFileStorage backend for this session.
2025-06-17 16:18:57,346 [INFO] [__main__] Starting scraping job with ID: job_20250617_201857_5fde843e
2025-06-17 16:18:57,347 [INFO] [__main__] Log file for this run is at: /home/piwe001/course-scraper/scraper.log
2025-06-17 16:18:57,348 [INFO] [__main__] === STARTING: brown_university ===
2025-06-17 16:18:57,348 [INFO] [__main__] [brown_university] Loaded 248 URLs from storage.
2025-06-17 16:18:57,348 [INFO] [__main__] [brown_university] No valid schema in storage, generating new schema.
2025-06-17 16:19:22,277 [INFO] [src.schema_manager] Generated schema for 'brown_university':
{'name': 'Brown University Course Catalog', 'baseSelector': '.courseblock', 'fields': [{'name': 'course_code', 'selector': '.courseblocktitle', 'type': 'text', 'attribute': 'data-code'}, {'name': 'course_title', 'selector': '.courseblocktitle', 'type': 'text'}, {'name': 'course_description', 'selector': '.courseblockdesc', 'type': 'text'}]}
2025-06-17 16:19:22,279 [INFO] [__main__] [brown_university] Generated new schema using {'prompt_tokens': 81195, 'total_tokens': 81315, 'completion_tokens': 120} tokens.
2025-06-17 16:19:22,279 [INFO] [__main__] [brown_university] Starting scrape for 248 URLs.
2025-06-17 16:19:22,366 [INFO] [__main__] === STARTING: pennsylvania_state_university ===
2025-06-17 16:19:22,366 [INFO] [__main__] [pennsylvania_state_university] No URLs in storage, starting new crawl.
2025-06-17 16:19:22,496 [INFO] [__main__] === STARTING: california_institute_of_technology ===
2025-06-17 16:19:22,496 [INFO] [__main__] [california_institute_of_technology] No URLs in storage, starting new crawl.
2025-06-17 16:19:22,923 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/azindex/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:23,192 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:23,644 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/law/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:24,703 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/undergraduate/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:25,028 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/dickinsonlaw/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:25,883 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/general-education/course-lists/humanities/') - RemoteProtocolError. Skipping.
2025-06-17 16:19:27,793 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/general-education/course-lists/ba-arts/') - RemoteProtocolError. Skipping.
2025-06-17 16:20:55,355 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/graduate/hist/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:10,847 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/graduate/insc/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:25,595 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/graduate/ldt/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:48,604 [ERROR] [__main__] !!! FAILED: brown_university at stage 'scrape' !!!
2025-06-17 16:21:48,604 [ERROR] [__main__] too many values to unpack (expected 2)
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 90, in process_source
    records, scrape_stats = await scrape_urls(urls, schema, source)
    ^^^^^^^^^^^^^^^^^^^^^
ValueError: too many values to unpack (expected 2)
2025-06-17 16:21:53,764 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/law/lwexp/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:55,823 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/pennstatelaw/iheac/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:56,046 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/pennstatelaw/expr/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:56,529 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/pennstatelaw/festl/') - RemoteProtocolError. Skipping.
2025-06-17 16:21:58,257 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/pennstatelaw/ihrdc/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:01,365 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/general-education/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:03,696 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/pennstatelaw/academics/master-laws-llm/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:04,633 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/pennstatelaw/general-information/financial-aid/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:04,860 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/pennstatelaw/general-information/contact/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:05,250 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/pennstatelaw/general-information/financial-aid/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:17,967 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/certificates/data-analytics-graduate-credit-certificate-program/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:20,818 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/majors/education/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:24,285 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/majors/energy-environmental-food-economics/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:39,378 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/certificates/nonprofit-administration-graduate-credit-certificate-program/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:39,944 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/majors/nursing/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:41,111 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/certificates/organization-development-change-analytics-graduate-credit-certificate-program/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:42,758 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/graduate/programs/majors/piano-performance/') - RemoteProtocolError. Skipping.
2025-06-17 16:22:45,473 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-undergraduate-students/graduation-requirements-all-options/political-science-option-ps/'). Skipping.
2025-06-17 16:22:45,610 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-undergraduate-students/graduation-requirements-all-options/robotics-minor-ro/'). Skipping.
2025-06-17 16:22:45,749 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-undergraduate-students/graduation-requirements-all-options/structural-mechanics-minor-sm/'). Skipping.
2025-06-17 16:22:45,899 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-undergraduate-students/graduation-requirements-all-options/visual-culture-minor-vc/'). Skipping.
2025-06-17 16:22:46,056 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/admission-to-graduate-standing/'). Skipping.
2025-06-17 16:22:46,202 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/visiting-student-appointments/'). Skipping.
2025-06-17 16:22:46,366 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/graduate-residence/'). Skipping.
2025-06-17 16:22:46,519 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/registration/'). Skipping.
2025-06-17 16:22:46,651 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/graduate-student-leaves-of-absence/'). Skipping.
2025-06-17 16:22:46,806 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/guidelines-for-graduate-student-advising/'). Skipping.
2025-06-17 16:22:47,069 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/part-time-programs/'). Skipping.
2025-06-17 16:22:47,173 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/responsible-conduct-of-research/'). Skipping.
2025-06-17 16:22:47,345 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/conflict-of-interest-and-commitment-of-graduate-students/'). Skipping.
2025-06-17 16:22:47,467 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/working-at-special-laboratories/'). Skipping.
2025-06-17 16:22:47,583 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-policies-and-procedures/exchange-program-with-scripps-institution-of-oceanography/'). Skipping.
2025-06-17 16:22:47,727 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/general-requirements-for-graduate-degrees/'). Skipping.
2025-06-17 16:22:47,841 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/graduate-expenses/'). Skipping.
2025-06-17 16:22:47,973 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/financial-assistance/'). Skipping.
2025-06-17 16:22:48,095 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/prizes-and-awards/'). Skipping.
2025-06-17 16:22:48,247 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/aerospace-ae/'). Skipping.
2025-06-17 16:22:48,412 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/applied-and-computational-mathematics-acm/'). Skipping.
2025-06-17 16:22:48,545 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/applied-mechanics-am/'). Skipping.
2025-06-17 16:22:48,647 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/applied-physics-aph/'). Skipping.
2025-06-17 16:22:48,782 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/astrophysics-ay/'). Skipping.
2025-06-17 16:22:48,897 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/biochemistry-and-molecular-biophysics-bmb/'). Skipping.
2025-06-17 16:22:49,058 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/bioengineering-be/'). Skipping.
2025-06-17 16:22:49,311 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/biology-bi/'). Skipping.
2025-06-17 16:22:49,505 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/chemical-engineering-che/'). Skipping.
2025-06-17 16:22:49,620 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/chemistry-ch/'). Skipping.
2025-06-17 16:22:49,773 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/civil-engineering-ce/'). Skipping.
2025-06-17 16:22:49,883 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/computation-and-neural-systems-cns/'). Skipping.
2025-06-17 16:22:50,027 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/computational-science-and-engineering-cse/'). Skipping.
2025-06-17 16:22:50,217 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/computer-science-cs/'). Skipping.
2025-06-17 16:22:50,382 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/computing-and-mathematical-science-cms/'). Skipping.
2025-06-17 16:22:50,503 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/control-and-dynamical-systems-cds/'). Skipping.
2025-06-17 16:22:50,682 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/electrical-engineering-ee/'). Skipping.
2025-06-17 16:22:50,850 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/environmental-science-and-engineering-ese/'). Skipping.
2025-06-17 16:22:50,970 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/geological-and-planetary-sciences-gps-geology-geobiology-geochemistry-geophysics-planetary-science/'). Skipping.
2025-06-17 16:22:51,077 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/history-h/'). Skipping.
2025-06-17 16:22:51,197 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/history-and-philosophy-of-science-hps/'). Skipping.
2025-06-17 16:22:51,395 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/information-and-data-science-ids/'). Skipping.
2025-06-17 16:22:51,663 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/materials-science-ms/'). Skipping.
2025-06-17 16:22:51,784 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/mathematics-ma/'). Skipping.
2025-06-17 16:22:51,904 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/mechanical-engineering-me/'). Skipping.
2025-06-17 16:22:52,059 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/medical-engineering-mede/'). Skipping.
2025-06-17 16:22:52,164 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/neurobiology-nb/'). Skipping.
2025-06-17 16:22:52,295 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/physics-ph/'). Skipping.
2025-06-17 16:22:52,459 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/quantum-science-and-engineering-qse/'). Skipping.
2025-06-17 16:22:52,705 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/social-and-decision-neuroscience-sdn/'). Skipping.
2025-06-17 16:22:52,834 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/information-for-graduate-students/special-regulations-for-graduate-options/social-science-ss/'). Skipping.
2025-06-17 16:22:52,979 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ae/'). Skipping.
2025-06-17 16:22:53,132 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/An/'). Skipping.
2025-06-17 16:22:53,277 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/ACM/'). Skipping.
2025-06-17 16:22:53,429 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/AM/'). Skipping.
2025-06-17 16:22:53,570 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/APh/'). Skipping.
2025-06-17 16:22:53,825 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ay/'). Skipping.
2025-06-17 16:22:53,975 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/BMB/'). Skipping.
2025-06-17 16:22:54,118 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/BE/'). Skipping.
2025-06-17 16:22:54,250 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Bi/'). Skipping.
2025-06-17 16:22:54,399 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/BEM/'). Skipping.
2025-06-17 16:22:54,535 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/ChE/'). Skipping.
2025-06-17 16:22:54,651 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ch/'). Skipping.
2025-06-17 16:22:54,780 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/CE/'). Skipping.
2025-06-17 16:22:54,897 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/CNS/'). Skipping.
2025-06-17 16:22:55,053 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/CS/'). Skipping.
2025-06-17 16:22:55,164 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/CMS/'). Skipping.
2025-06-17 16:22:55,311 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/CDS/'). Skipping.
2025-06-17 16:22:55,453 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ec/'). Skipping.
2025-06-17 16:22:55,598 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/EE/'). Skipping.
2025-06-17 16:22:55,799 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/EST/'). Skipping.
2025-06-17 16:22:55,983 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/E/'). Skipping.
2025-06-17 16:22:56,096 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/En/'). Skipping.
2025-06-17 16:22:56,282 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/ESL/'). Skipping.
2025-06-17 16:22:56,397 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/ESE/'). Skipping.
2025-06-17 16:22:56,549 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/FS/'). Skipping.
2025-06-17 16:22:56,683 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ge/'). Skipping.
2025-06-17 16:22:56,869 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/H/'). Skipping.
2025-06-17 16:22:56,976 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/HPS/'). Skipping.
2025-06-17 16:22:57,143 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Hum/'). Skipping.
2025-06-17 16:22:57,246 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/IDS/'). Skipping.
2025-06-17 16:22:57,447 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/IST/'). Skipping.
2025-06-17 16:22:57,661 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/L/'). Skipping.
2025-06-17 16:22:57,812 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Law/'). Skipping.
2025-06-17 16:22:57,926 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/MS/'). Skipping.
2025-06-17 16:22:58,076 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ma/'). Skipping.
2025-06-17 16:22:58,203 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/ME/'). Skipping.
2025-06-17 16:22:58,608 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/MedE/'). Skipping.
2025-06-17 16:22:58,744 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Mu/'). Skipping.
2025-06-17 16:22:58,926 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/NB/'). Skipping.
2025-06-17 16:22:59,048 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/PVA/'). Skipping.
2025-06-17 16:22:59,178 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Pl/'). Skipping.
2025-06-17 16:22:59,452 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/PE/'). Skipping.
2025-06-17 16:22:59,620 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Ph/'). Skipping.
2025-06-17 16:22:59,909 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/PS/'). Skipping.
2025-06-17 16:23:00,112 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Psy/'). Skipping.
2025-06-17 16:23:00,235 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/SEC/'). Skipping.
2025-06-17 16:23:00,411 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/SS/'). Skipping.
2025-06-17 16:23:00,552 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/SA/'). Skipping.
2025-06-17 16:23:00,775 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/VC/'). Skipping.
2025-06-17 16:23:00,881 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/department/Wr/'). Skipping.
2025-06-17 16:23:01,027 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/officers/'). Skipping.
2025-06-17 16:23:01,232 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/board-of-trustees/'). Skipping.
2025-06-17 16:23:01,407 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/administrative-officers/'). Skipping.
2025-06-17 16:23:01,583 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/faculty-officers-and-board/'). Skipping.
2025-06-17 16:23:01,740 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-biology-and-biological-engineering/'). Skipping.
2025-06-17 16:23:01,881 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-chemistry-and-chemical-engineering/'). Skipping.
2025-06-17 16:23:02,007 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-engineering-and-applied-science/'). Skipping.
2025-06-17 16:23:02,149 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-geological-and-planetary-sciences/'). Skipping.
2025-06-17 16:23:02,368 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-the-humanities-and-social-sciences/'). Skipping.
2025-06-17 16:23:02,623 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/division-of-physics-mathematics-and-astronomy/'). Skipping.
2025-06-17 16:23:02,800 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/staff-of-instruction-and-research/jet-propulsion-laboratory/'). Skipping.
2025-06-17 16:23:02,976 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/trustees-administration-faculty/officers-and-faculty/'). Skipping.
2025-06-17 16:23:03,075 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/academic-calendar/'). Skipping.
2025-06-17 16:23:03,301 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/admin/login/'). Skipping.
2025-06-17 16:23:03,324 [INFO] [__main__] [california_institute_of_technology] Crawl found 495 potential URLs.
2025-06-17 16:23:13,884 [INFO] [__main__] [california_institute_of_technology] Prefiltered to 2 valid URLs.
2025-06-17 16:23:13,886 [INFO] [__main__] [california_institute_of_technology] No valid schema in storage, generating new schema.
2025-06-17 16:23:14,083 [ERROR] [__main__] !!! FAILED: california_institute_of_technology at stage 'schema' !!!
2025-06-17 16:23:14,084 [ERROR] [__main__] target_html cannot be empty
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 79, in process_source
    schema, usage = await generate_schema(source)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/piwe001/course-scraper/src/schema_manager.py", line 27, in generate_schema
    schema, usage = await _generate_schema_from_llm(url=source.schema_url)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/piwe001/course-scraper/src/schema_manager.py", line 50, in _generate_schema_from_llm
    course_prompt.set_target_html(html_for_schema)
  File "/home/piwe001/course-scraper/src/prompts/find_repeating.py", line 143, in set_target_html
    raise ValueError("target_html cannot be empty")
ValueError: target_html cannot be empty
2025-06-17 16:23:18,336 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/intercollege/civic-community-engagement-minor/') - RemoteProtocolError. Skipping.
2025-06-17 16:23:33,532 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/behrend/english-ba/') - RemoteProtocolError. Skipping.
2025-06-17 16:23:34,609 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/behrend/erp-with-sap-certificate/') - RemoteProtocolError. Skipping.
2025-06-17 16:23:37,674 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/liberal-arts/ethics-minor/') - RemoteProtocolError. Skipping.
2025-06-17 16:23:38,030 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/abington/finance-bs/') - RemoteProtocolError. Skipping.
2025-06-17 16:23:41,772 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/colleges/earth-mineral-sciences/geosciences-bs/') - RemoteProtocolError. Skipping.
2025-06-17 16:25:24,540 [INFO] [__main__] Using LocalFileStorage backend for this session.
2025-06-17 16:25:24,540 [INFO] [__main__] Starting scraping job with ID: job_20250617_202524_819e7858
2025-06-17 16:25:24,540 [INFO] [__main__] Log file for this run is at: /home/piwe001/course-scraper/scraper.log
2025-06-17 16:25:24,541 [INFO] [__main__] === STARTING: brown_university ===
2025-06-17 16:25:24,542 [INFO] [__main__] [brown_university] Loaded 248 URLs from storage.
2025-06-17 16:25:24,542 [ERROR] [__main__] !!! FAILED: brown_university at stage 'schema' !!!
2025-06-17 16:25:24,542 [ERROR] [__main__] expected str, bytes or os.PathLike object, not module
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 76, in process_source
    schema = await storage.get_schema(source.name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/piwe001/course-scraper/src/storage.py", line 135, in get_schema
    with open(path, "r") as f: return f
         ^^^^^^^^^^^^^^^
TypeError: expected str, bytes or os.PathLike object, not module
2025-06-17 16:25:24,543 [INFO] [__main__] === STARTING: pennsylvania_state_university ===
2025-06-17 16:25:24,543 [INFO] [__main__] [pennsylvania_state_university] No URLs in storage, starting new crawl.
2025-06-17 16:25:24,626 [INFO] [__main__] === STARTING: california_institute_of_technology ===
2025-06-17 16:25:24,626 [INFO] [__main__] [california_institute_of_technology] No URLs in storage, starting new crawl.
2025-06-17 16:25:24,757 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/'). Skipping.
2025-06-17 16:25:24,757 [INFO] [__main__] [california_institute_of_technology] Crawl found 1 potential URLs.
2025-06-17 16:25:24,909 [INFO] [__main__] [california_institute_of_technology] Prefiltered to 0 valid URLs.
2025-06-17 16:25:24,909 [ERROR] [__main__] !!! FAILED: california_institute_of_technology at stage 'crawl' !!!
2025-06-17 16:25:24,909 [ERROR] [__main__] No valid URLs found after crawl and prefilter.
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 72, in process_source
    raise ValueError("No valid URLs found after crawl and prefilter.")
ValueError: No valid URLs found after crawl and prefilter.
2025-06-17 16:25:27,645 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/undergraduate/general-education/course-lists/humanities/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:06,417 [INFO] [__main__] Using LocalFileStorage backend for this session.
2025-06-17 16:27:06,418 [INFO] [__main__] Starting scraping job with ID: job_20250617_202706_9154ac52
2025-06-17 16:27:06,418 [INFO] [__main__] Log file for this run is at: /home/piwe001/course-scraper/scraper.log
2025-06-17 16:27:06,419 [INFO] [__main__] === STARTING: brown_university ===
2025-06-17 16:27:06,419 [INFO] [__main__] [brown_university] No URLs in storage, starting new crawl.
2025-06-17 16:27:06,502 [INFO] [__main__] === STARTING: pennsylvania_state_university ===
2025-06-17 16:27:06,502 [INFO] [__main__] [pennsylvania_state_university] No URLs in storage, starting new crawl.
2025-06-17 16:27:06,529 [INFO] [__main__] === STARTING: california_institute_of_technology ===
2025-06-17 16:27:06,529 [INFO] [__main__] [california_institute_of_technology] No URLs in storage, starting new crawl.
2025-06-17 16:27:06,664 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/'). Skipping.
2025-06-17 16:27:06,665 [INFO] [__main__] [california_institute_of_technology] Crawl found 1 potential URLs.
2025-06-17 16:27:06,784 [INFO] [__main__] [california_institute_of_technology] Prefiltered to 0 valid URLs.
2025-06-17 16:27:06,785 [ERROR] [__main__] !!! FAILED: california_institute_of_technology at stage 'crawl' !!!
2025-06-17 16:27:06,785 [ERROR] [__main__] No valid URLs found after crawl and prefilter.
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 72, in process_source
    raise ValueError("No valid URLs found after crawl and prefilter.")
ValueError: No valid URLs found after crawl and prefilter.
2025-06-17 16:27:06,848 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/azindex/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:07,496 [WARNING] [src.crawler] Request failed for URL('https://bulletin.brown.edu/the-college/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:08,183 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/undergraduate/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:35,116 [INFO] [__main__] Using LocalFileStorage backend for this session.
2025-06-17 16:27:35,117 [INFO] [__main__] Starting scraping job with ID: job_20250617_202735_953a1d4d
2025-06-17 16:27:35,117 [INFO] [__main__] Log file for this run is at: /home/piwe001/course-scraper/scraper.log
2025-06-17 16:27:35,119 [INFO] [__main__] === STARTING: brown_university ===
2025-06-17 16:27:35,119 [INFO] [__main__] [brown_university] No URLs in storage, starting new crawl.
2025-06-17 16:27:35,200 [INFO] [__main__] === STARTING: pennsylvania_state_university ===
2025-06-17 16:27:35,200 [INFO] [__main__] [pennsylvania_state_university] No URLs in storage, starting new crawl.
2025-06-17 16:27:35,227 [INFO] [__main__] === STARTING: california_institute_of_technology ===
2025-06-17 16:27:35,227 [INFO] [__main__] [california_institute_of_technology] No URLs in storage, starting new crawl.
2025-06-17 16:27:35,343 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/'). Skipping.
2025-06-17 16:27:35,343 [INFO] [__main__] [california_institute_of_technology] Crawl found 1 potential URLs.
2025-06-17 16:27:35,484 [WARNING] [src.crawler] Request failed for URL('https://bulletin.brown.edu/azindex/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:35,484 [INFO] [__main__] [california_institute_of_technology] Prefiltered to 0 valid URLs.
2025-06-17 16:27:35,485 [ERROR] [__main__] !!! FAILED: california_institute_of_technology at stage 'crawl' !!!
2025-06-17 16:27:35,485 [ERROR] [__main__] No valid URLs found after crawl and prefilter.
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 72, in process_source
    raise ValueError("No valid URLs found after crawl and prefilter.")
ValueError: No valid URLs found after crawl and prefilter.
2025-06-17 16:27:35,769 [WARNING] [src.crawler] Request failed for URL('https://bulletin.brown.edu/leadership/') - RemoteProtocolError. Skipping.
2025-06-17 16:27:38,763 [WARNING] [src.crawler] HTTP error 404 for URL('https://bulletin.brown.edu/undergradproftrack/'). Skipping.
2025-06-17 16:28:37,150 [INFO] [__main__] Using LocalFileStorage backend for this session.
2025-06-17 16:28:37,150 [INFO] [__main__] Starting scraping job with ID: job_20250617_202837_5b216360
2025-06-17 16:28:37,150 [INFO] [__main__] Log file for this run is at: /home/piwe001/course-scraper/scraper.log
2025-06-17 16:28:37,151 [INFO] [__main__] === STARTING: brown_university ===
2025-06-17 16:28:37,151 [INFO] [__main__] [brown_university] No URLs in storage, starting new crawl.
2025-06-17 16:28:37,230 [INFO] [__main__] === STARTING: pennsylvania_state_university ===
2025-06-17 16:28:37,230 [INFO] [__main__] [pennsylvania_state_university] No URLs in storage, starting new crawl.
2025-06-17 16:28:37,263 [INFO] [__main__] === STARTING: california_institute_of_technology ===
2025-06-17 16:28:37,263 [INFO] [__main__] [california_institute_of_technology] No URLs in storage, starting new crawl.
2025-06-17 16:28:37,405 [WARNING] [src.crawler] HTTP error 429 for URL('https://catalog.caltech.edu/current/2024-25/'). Skipping.
2025-06-17 16:28:37,406 [INFO] [__main__] [california_institute_of_technology] Crawl found 1 potential URLs.
2025-06-17 16:28:37,603 [INFO] [__main__] [california_institute_of_technology] Prefiltered to 0 valid URLs.
2025-06-17 16:28:37,603 [ERROR] [__main__] !!! FAILED: california_institute_of_technology at stage 'crawl' !!!
2025-06-17 16:28:37,603 [ERROR] [__main__] No valid URLs found after crawl and prefilter.
Traceback (most recent call last):
  File "/home/piwe001/course-scraper/src/main.py", line 72, in process_source
    raise ValueError("No valid URLs found after crawl and prefilter.")
ValueError: No valid URLs found after crawl and prefilter.
2025-06-17 16:28:38,264 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/') - RemoteProtocolError. Skipping.
2025-06-17 16:28:38,455 [WARNING] [src.crawler] Request failed for URL('https://bulletin.brown.edu/leadership/') - RemoteProtocolError. Skipping.
2025-06-17 16:28:38,931 [WARNING] [src.crawler] Request failed for URL('https://bulletin.brown.edu/the-college/') - RemoteProtocolError. Skipping.
2025-06-17 16:28:39,481 [WARNING] [src.crawler] Request failed for URL('https://bulletins.psu.edu/university-course-descriptions/undergraduate/') - RemoteProtocolError. Skipping.
